{% extends "main.html" %}

{% block content %}
<main class="container">

  <header class="flex center-between" style="margin-bottom: var(--sp-6);">
    <div>
      <h1>Profiles</h1>
      <p class="muted">
        {{ profiles|length }} total
      </p>
    </div>

    <form class="search-bar" method="get" action="">
      <input type="search" name="q" value="{{ search_query }}" placeholder="Search peopleâ€¦" aria-label="Search profiles">
      <button class="btn btn-primary" type="submit"><i class="fa-solid fa-magnifying-glass"></i> Search</button>
    </form>
  </header>

  {% if profiles %}
  <section class="grid goals-grid" aria-label="Profiles list">
    {% for profile in profiles %}
    <article class="card">
      <a href="{% url 'profile' profile.id %}" style="display:block">
        <div class="profile-header">
          <img
            class="profile-pic"
            src="{{ profile.profile_img.url }}"
            alt="{{ profile.name }}"
            loading="lazy"
            decoding="async"
          />
          <div class="profile-info">
            <h3 style="margin: 0 0 var(--sp-1);">{{ profile.name }}</h3>

            {% if profile.synopsis %}
            <p class="muted clamp-1">
              {{ profile.synopsis }}
            </p>
            {% endif %}
          </div>
        </div>

        {% if profile.bio %}
        <p class="muted clamp-3" style="margin-top: var(--sp-4);">
          {{ profile.bio }}
        </p>
        {% endif %}

        <ul class="flex" style="flex-wrap: wrap; gap: var(--sp-2); margin-top: var(--sp-3);">
          {% for interest in profile.interest_set.all %}
            <li class="tag tag--blue">{{ interest.name }}</li>
          {% endfor %}
        </ul>
      </a>
    </article>
    {% endfor %}
  </section>

  {% else %}
  <section class="card" style="text-align:center; padding: var(--sp-8);">
    <h2>No profiles match</h2>
    <p class="muted" style="margin-top: var(--sp-2);">Create a profile to get started.</p>
    <a class="btn btn-primary" href="{% url 'register' %}" style="margin-top: var(--sp-4);">+ New Profile</a>
  </section>
  {% endif %}

</main>
{% endblock content %}
